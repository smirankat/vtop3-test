const yearSelect=document.getElementById("year"),monthSelect=document.getElementById("month"),daySelect=document.getElementById("day"),months=["January","February","March","April","May","June","July","August","September","October","November","December"];let previousDay;function populateDays(e){for(;daySelect.firstChild;)daySelect.removeChild(daySelect.firstChild);let t,a=yearSelect.value;t="January"===e||"March"===e||"May"===e||"July"===e||"August"===e||"October"===e||"December"===e?31:"April"===e||"June"===e||"September"===e||"November"===e?30:1===new Date(a,1,29).getMonth()?29:28;for(let e=1;e<=t;e++){const t=document.createElement("option");t.textContent=e,daySelect.appendChild(t)}previousDay&&(daySelect.value=previousDay,""===daySelect.value&&(daySelect.value=previousDay-1),""===daySelect.value&&(daySelect.value=previousDay-2),""===daySelect.value&&(daySelect.value=previousDay-3))}function populateYears(){let e=(new Date).getFullYear();for(let t=0;t<101;t++){const a=document.createElement("option");a.textContent=e-t,yearSelect.appendChild(a)}}!function(){for(let e=0;e<months.length;e++){const t=document.createElement("option");t.textContent=months[e],monthSelect.appendChild(t)}monthSelect.value="December"}(),populateDays(monthSelect.value),populateYears(),yearSelect.onchange=function(){populateDays(monthSelect.value)},monthSelect.onchange=function(){populateDays(monthSelect.value)},daySelect.onchange=function(){previousDay=daySelect.value},daySelect.value=21,yearSelect.value=1995;const inputFirstName=document.getElementById("first-name"),inputLastName=document.getElementById("last-name"),inputEmail=document.getElementById("email"),inputPsw=document.getElementById("psw"),inputPswRepeat=document.getElementById("psw-repeat"),emailError=document.querySelector("#email + span"),pswError=document.querySelector("#psw + span"),pswRepeatError=document.querySelector("#psw-repeat + span"),submitButton=document.querySelector(".signup-btn");let validEmail;const re=/^\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/;function showEmailError(){inputEmail.value?validEmail||(emailError.textContent="Incorrect value entered"):emailError.textContent="You need to enter your email",emailError.className="error",inputEmail.className="invalid"}let validPsw;function showPswError(){inputPsw.value?validPsw||(pswError.textContent="Incorrect value entered"):pswError.textContent="Please enter your password",pswError.className="error",inputPsw.className="invalid"}function showPswRepeatError(){inputPswRepeat.value&&inputPsw.value&&validPsw?inputPswRepeat.value!==inputPsw.value&&(pswRepeatError.textContent="Passwords do not match"):pswRepeatError.textContent="Please repeat your correct password",pswRepeatError.className="error",inputPswRepeat.className="invalid"}function AnimationHandler(){submitButton.classList.remove("shake")}validEmail=re.test(inputEmail.value),inputEmail.addEventListener("input",(function(){validEmail=re.test(inputEmail.value),inputEmail.value&&validEmail?(emailError.textContent="",emailError.className="",inputEmail.className="email"):showEmailError()})),inputPsw.addEventListener("input",(function(){validPsw=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}$/.test(inputPsw.value),inputPsw.value&&validPsw?(pswError.textContent="",pswError.className="",inputPsw.className=""):showPswError()})),inputPswRepeat.addEventListener("input",(function(){inputPsw.value&&validPsw&&inputPswRepeat.value&&inputPswRepeat.value===inputPsw.value?(pswRepeatError.textContent="",pswRepeatError.className="",inputPswRepeat.className="",inputPsw.className=""):(showPswError(),showPswRepeatError())})),document.forms.formName.onsubmit=async e=>{if(e.preventDefault(),!(inputEmail.value&&validEmail&&inputPsw.value&&validPsw&&inputPswRepeat.value&&inputPswRepeat.value===inputPsw.value))return submitButton.className="signup-btn shake",inputEmail.value&&validEmail||showEmailError(),inputPsw.value&&validPsw||showPswError(),void(inputPswRepeat.value&&inputPswRepeat.value===inputPsw.value||showPswRepeatError());if(inputEmail.value&&inputPsw.value&&inputPswRepeat.value){let e=inputEmail.value,t=inputPsw.value,a=JSON.stringify({email:e,password:t});await fetch("/",{method:"POST",headers:{"Content-Type":"application/json;charset=UTF-8"},body:a});alert("Регистрация прошла успешно"),inputFirstName.value="",inputLastName.value="",inputEmail.value="",inputPsw.value="",inputPswRepeat.value=""}},submitButton.addEventListener("animationend",AnimationHandler,!1);